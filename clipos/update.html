

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>System updates &mdash; CLIP OS 5.0.0_alpha1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/colors.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Roadmap" href="roadmap.html" />
    <link rel="prev" title="Boot chain and integrity guarantees" href="boot_integrity.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CLIP OS
          

          
            
            <img src="../_static/clipos_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                5.0 (Alpha)
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">CLIP OS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security objectives</a></li>
<li class="toctree-l1"><a class="reference internal" href="kernel.html">Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="boot_integrity.html">Boot chain and integrity guarantees</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">System updates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#threats-considered">Threats considered</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation">Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#security">Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#unaddressed-threats-and-potential-weaknesses">Unaddressed threats and potential weaknesses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development and debug</a></li>
</ul>
<p class="caption"><span class="caption-text">Development environment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/setup.html">Environment setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/build.html">Building</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/build-steps.html">Build steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/source-tree.html">Source tree organization</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/contribute.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../toolkit/derive.html">How to derive this project</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CLIP OS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>System updates</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/clipos/update.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="system-updates">
<span id="update"></span><h1>System updates<a class="headerlink" href="#system-updates" title="Permalink to this headline">¶</a></h1>
<p>Safe, convenient and regular updates are required to ensure that a CLIP OS
system is able to enforce and keep its security properties over time.</p>
<div class="notice admonition">
<p class="first admonition-title">Goal of this document</p>
<p class="last">This document is a global description of the update model. Please see the
<a class="reference external" href="https://github.com/clipos/src_platform_updater">update client documentation</a> for instructions on
client configuration and server setup.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>The following properties are required for the interaction between updates and
the local system (client side):</p>
<blockquote>
<div><ul class="simple">
<li><strong>Safe</strong>: Updates must never interfere with the currently running system
and must be safe to apply while the system is online and in use.</li>
<li><strong>In-background</strong>: Updates should happen transparently to the user and in
the background.</li>
<li><strong>Atomic</strong>: Updates are either completely installed or not available as a
choice during system boot. A system should always boot by default to a
properly installed version and never into a partially updated system.</li>
<li><strong>Rollback</strong>: If the newly updated system has issues, the user must be able
to return temporarily to the previous version until a new update is
available.</li>
</ul>
</div></blockquote>
<p>The following properties are required to control update deployments (server
side):</p>
<blockquote>
<div><ul class="simple">
<li><strong>Client identification</strong>: Administrators must be able to identify requests
for each client. This indirectly allows administrators to check for system
usage and aliveness.</li>
<li><strong>Client version reporting</strong>: Administrators must be able to identify which
version is installed on each client.</li>
<li><strong>Update channels (alpha, beta, stable)</strong>: Administrators must be able to
progressively deploy an update to small groups of clients for live tests.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="threats-considered">
<h2>Threats considered<a class="headerlink" href="#threats-considered" title="Permalink to this headline">¶</a></h2>
<p>Here is a list of threat scenario considered and for which we would like to
protect the system from regarding the update process:</p>
<ol class="arabic simple">
<li>Compromised update server:<ul>
<li>Has full control over the content served to the client.</li>
<li>Has no direct physical access to the system.</li>
<li>Does not have access to the update signing key.</li>
</ul>
</li>
<li>Active man-in-the-middle attacker:<ul>
<li>Has full control over the external network on which is connected the
workstation.</li>
<li>Has no direct physical access to the system.</li>
<li>Does not have access to the update signing key.</li>
</ul>
</li>
<li>Active local attacker:<ul>
<li>Has full control over the external network on which is connected the
workstation.</li>
<li>Has full physical access to the system.</li>
<li>Does not have access to the update signing key.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>CLIP OS systems have the following system layout:</p>
<blockquote>
<div><ul class="simple">
<li>UEFI boot only, following the <a class="reference external" href="https://systemd.io/BOOT_LOADER_SPECIFICATION.html">Boot Loader Specification</a>.</li>
<li>A/B partition setup using Logical Volumes for system Read-Only partitions
(for example: Core).</li>
<li>Single partition setup for stateful partitions.</li>
</ul>
</div></blockquote>
<p>Updating a CLIP OS system is equivalent to:</p>
<blockquote>
<div><ul class="simple">
<li>Downloading the latest Core partition and EFI binary from the update
server.</li>
<li>Installing the Core partition in the currently unused Logical Volume or
creating a new one if only one exists.</li>
<li>Installing the EFI binary with a name following the <a class="reference external" href="https://systemd.io/BOOT_LOADER_SPECIFICATION.html">Boot Loader
Specification</a> and
removing binaries associated with previous and now unavailable versions.</li>
<li>Rebooting the system to automatically boot the new version.</li>
</ul>
</div></blockquote>
<p>The requirements for the client are met with the following implementation:</p>
<blockquote>
<div><ul class="simple">
<li><strong>Safe</strong>: Since updates are never applied onto files or partitions
currently used by the running system, they can be performed without
impacting the system integrity.</li>
<li><strong>In-background</strong>: As updates do not impact the currently running system,
they can performed in background without user interaction. They will only
be effective after a reboot. There is no additional update process at
shutdown/boot time.</li>
<li><strong>Atomic</strong>: The system is either updated or not. Updates may be partially
applied but the system will not see them and will always boot on the latest
working version. Updates applied at the Logical Volume granularity for the
system partition (Core).</li>
<li><strong>Rollback</strong>: Two versions of the system are always available for user
choice during boot. If the new system has critical bugs, the user may
choose to revert to the previously working version until the next update.</li>
</ul>
</div></blockquote>
<p>The requirements for control applied on the server side are met with the
following implementation:</p>
<blockquote>
<div><ul>
<li><p class="first"><strong>Client identification</strong>: Each request made by the client includes the
system’s current machine-id thus providing a unique and stable identifier.</p>
</li>
<li><p class="first"><strong>Client version reporting</strong>: Each request made by the client includes the
system’s current version.</p>
</li>
<li><p class="first"><strong>Update channels (alpha, beta, stable)</strong>: As version and identification
are provided on each request, the server is able to decide which version to
provide to each client.</p>
<div class="notice admonition">
<p class="first admonition-title">Status</p>
<p class="last">The server side implementation of update channels has not been
implemented yet.</p>
</div>
</li>
</ul>
</div></blockquote>
<div class="section" id="security">
<h3>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h3>
<p>The update process security properties are implemented using the following
security features:</p>
<blockquote>
<div><ul class="simple">
<li>In transport confidentiality and integrity:<ul>
<li>HTTPS using TLS 1.2 &amp; 1.3 only.</li>
<li>Pinned Root Certificate Authority (requires an empty set of system
certificates).</li>
</ul>
</li>
<li>At rest integrity:<ul>
<li>Each update payload is verified using a cryptographic signature produced
by <cite>minisign</cite> / <cite>rsign2</cite>.</li>
</ul>
</li>
<li>Rollback resistance (during update process):<ul>
<li>Update payload versions are specified as trusted comment in the signature
and are validated before the update is applied preventing an attacker
from masquerading an old release as a new one.</li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="unaddressed-threats-and-potential-weaknesses">
<h2>Unaddressed threats and potential weaknesses<a class="headerlink" href="#unaddressed-threats-and-potential-weaknesses" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Offline rollback resistance: There is currently no protection against a local
attacker replacing the currently installed version of the system by an older
and valid version with direct disk access.</li>
<li>Update signing key compromise: There is currently no mitigation strategy for
a compromise of the update signing key.</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="roadmap.html" class="btn btn-neutral float-right" title="Roadmap" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="boot_integrity.html" class="btn btn-neutral float-left" title="Boot chain and integrity guarantees" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, ANSSI. CLIP OS is a trademark of the French Republic. For more details, see the &#34;How to derive this project&#34; section. The contents of this documentation is available under the Open License version 2.0 as published by Etalab (French task force for Open Data)

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>